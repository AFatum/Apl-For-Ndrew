CREATE TABLE test1 
(
	id INT UNSIGNED NOT NULL AUTO_INCREMENT,
	code INT,
	PRIMARY KEY (id)
) COMMENT 'тестовая ООП',
ENGINE=InnoDB;


CREATE TABLE results 
(
	id INT UNSIGNED NOT NULL AUTO_INCREMENT,
	с1 VARCHAR(50) NOT NULL DEFAULT '',
	с2 VARCHAR(50) NOT NULL DEFAULT '',
	result INT DEFAULT NULL,
	tour INT NOT NULL,
	date DATE NOT NULL,
	PRIMARY KEY (id)
) COMMENT 'таблица результатов матчей',
ENGINE=InnoDB;

DROP TABLE IF EXISTS rt1;

CREATE TABLE rt1
(
	id INT UNSIGNED NOT NULL AUTO_INCREMENT,
	t1 VARCHAR(20) NOT NULL DEFAULT '',
	t2 VARCHAR(20) NOT NULL DEFAULT '',
	g1 INT DEFAULT NULL,
	g2 INT DEFAULT NULL,
	date DATE NOT NULL,
	PRIMARY KEY (id)
) COMMENT 'Таблица результатов матчей первого тура',
ENGINE=InnoDB;


DROP TABLE IF EXISTS results;
CREATE TABLE results
(
	id INT UNSIGNED NOT NULL AUTO_INCREMENT,
	t1 VARCHAR(20) NOT NULL DEFAULT '',
	t2 VARCHAR(20) NOT NULL DEFAULT '',
	g1 INT DEFAULT NULL,
	g2 INT DEFAULT NULL,
	tour INT NOT NULL,
	date DATE NOT NULL,
	PRIMARY KEY (id)
) COMMENT 'Таблица результатов матчей',
ENGINE=InnoDB;

SELECT	table_name, 
		table_comment,
		table_rows,
		ENGINE,
		table_collation
	FROM information_schema.tables
	WHERE table_schema = 'apl';
	
	DROP VIEW IF EXISTS tab_info;
CREATE VIEW currCourses AS
	SELECT DISTINCT course
		FROM lessons
		WHERE MONTH(lesson_date) = 9
		  AND YEAR(lesson_date) = 2006
		  
		  
DELIMITER |
CREATE PROCEDURE det ()
SELECT	table_name, 
		table_comment,
		table_rows,
		ENGINE,
		table_collation
	FROM information_schema.tables
	WHERE table_schema = 'apl';
END; |
DELIMITER ;

DROP PROCEDURE IF EXISTS col_info;
DROP PROCEDURE IF EXISTS table_info;

DELIMITER |
CREATE PROCEDURE des (IN tb CHARACTER (20))
SELECT	column_name, 
		data_type,
		column_default,
		is_nullable,
		column_key,
		extra,
		column_comment
	FROM information_schema.columns
	WHERE table_schema = 'apl'
	AND table_name = tb;
END; |
DELIMITER ;

DROP TABLE IF EXISTS pl;

CREATE TABLE pl
(
	id INT UNSIGNED NOT NULL AUTO_INCREMENT,
	name VARCHAR(20) NOT NULL DEFAULT 'comand',
	plays INT NOT NULL DEFAULT '0',
	wins INT NOT NULL DEFAULT '0',
	nich INT NOT NULL DEFAULT '0',
	lose INT NOT NULL DEFAULT '0',
	goals_out INT NOT NULL DEFAULT '0',
	goals_in INT NOT NULL DEFAULT '0',
	goals_res INT NOT NULL DEFAULT '0',
	points INT NOT NULL DEFAULT '0',
	PRIMARY KEY (id)
) COMMENT 'Итоговая турнирная таблица Английской премьер-лиги',
ENGINE=InnoDB;

INSERT INTO pl (name) VALUES ('Арсенал'),
							('Бернли'),
							('Борнмут'),
							('Вест Бромвич'),
							('Вест Хэм'),
							('Кристал Пэлас'),
							('Лестер Сити'),
							('Ливерпуль'),
							('Манчестер Сити'),
							('Манчестер Юнайтед'),
							('Мидлсбро'),
							('Сандерленд'),
							('Саутгемптон'),
							('Сток Сити'),
							('Суонси'),
							('Тоттенхэм'),
							('Уотфорд'),
							('Халл Сити'),
							('Челси'),
							('Эвертон');
							
INSERT INTO rt1 (t1, t2, g1, g2, date) VALUES
				('Халл Сити', 'Лестер Сити', 2, 1, '13.08.2016'),
				('Бернли', 'Суонси', 0, 1, '13.08.2016'),
				('Кристал Пэлас', ' Вест Бромвич', 0, 1, '13.08.2016'),
				('Халл Сити', 'Лестер Сити', 2, 1, '13.08.2016'),
				('Халл Сити', 'Лестер Сити', 2, 1, '13.08.2016'),	
				
INSERT INTO rt1 (t1, t2, date) VALUES
				('Борнмут',				'Манчестер Юнайтед',	'2016.08.13'),
				('Бернли',				'Суонси',				'2016.08.13'),
				('Кристал Пэлас',		'Вест Бромвич',			'2016.08.13'),
				('Эвертон',				'Тоттенхэм',			'2016.08.13'),
				('Миддлсбро',			'Сток Сити',			'2016.08.13'),
				('Саутгемптон',			'Уотфорд',				'2016.08.13'),
				('Манчестер Сити',		'Сандерленд',			'2016.08.13');
				('Борнмут',				'Манчестер Юнайтед',	'2016.08.13'),
				('Арсенал',				'Ливерпуль',			'2016.08.13'),
				('Челси',				'Вест Хэм',				'2016.08.13');	
				
INSERT INTO results (t1, t2, date, tour) VALUES
				('Халл Сити',			'Лестер Сити',			'2016.08.13',	1),
				('Бернли',				'Суонси',				'2016.08.13',	1),
				('Кристал Пэлас',		'Вест Бромвич',			'2016.08.13',	1),
				('Эвертон',				'Тоттенхэм',			'2016.08.13',	1),
				('Миддлсбро',			'Сток Сити',			'2016.08.13',	1),
				('Саутгемптон',			'Уотфорд',				'2016.08.13',	1),
				('Манчестер Сити',		'Сандерленд',			'2016.08.13',	1),
				('Борнмут',				'Манчестер Юнайтед',	'2016.08.14',	1),
				('Арсенал',				'Ливерпуль',			'2016.08.14',	1),
				('Челси',				'Вест Хэм',				'2016.08.15',	1);	
				
INSERT INTO results (t1, t2, date, tour) VALUES
				('Манчестер Юнайтед',	'Саутгемптон',			'2016.08.19',	2),
				('Сток Сити',			'Манчестер Сити',		'2016.08.20',	2),
				('Бернли',				'Ливерпуль',			'2016.08.20',	2),
				('Суонси',				'Халл Сити',			'2016.08.20',	2),
				('Тоттенхэм',			'Кристал Пэлас',		'2016.08.20',	2),
				('Уотфорд',				'Челси',				'2016.08.20',	2),
				('Вест Бромвич',		'Эвертон',				'2016.08.20',	2),
				('Лестер Сити',			'Арсенал',				'2016.08.20',	2),
				('Сандерленд',			'Миддлсбро',			'2016.08.21',	2),
				('Вест Хэм',			'Борнмут',				'2016.08.21',	2);
				
/* Тур - 4 */			
INSERT INTO results (t1, t2, date, tour) VALUES
				('Манчестер Юнайтед',	'Манчестер Сити',		'2016.08.19',	2),
				('Арсенал',				'Саутгемптон',			'2016.08.20',	2),
				('Борнмут',				'Вест Бромвич',			'2016.08.20',	2),
				('Бернли',				'Халл Сити',			'2016.08.20',	2),
				('Миддлсбро',			'Кристал Пэлас',		'2016.08.20',	2),
				('Сток Сити',			'Тоттенхэм',			'2016.08.20',	2),
				('Вест Хэм',			'Уотфорд',				'2016.08.20',	2),
				('Ливерпуль',			'Лестер Сити',			'2016.08.20',	2),
				('Суонси',				'Челси',				'2016.08.21',	2),
				('Сандерленд',			'Эвертон',				'2016.08.21',	2);				
/* Тур - 5-6 */			
INSERT INTO results (t1, t2, date, tour) VALUES
				('Челси',				'Ливерпуль',			'2016.08.19',	2),
				('Халл Сити',			'Арсенал',				'2016.08.20',	2),
				('Лестер Сити',			'Бернли',				'2016.08.20',	2),
				('Манчестер Сити',		'Борнмут',				'2016.08.20',	2),
				('Вест Бромвич',		'Вест Хэм',				'2016.08.20',	2),
				('Эвертон',				'Миддлсбро',			'2016.08.20',	2),
				('Уотфорд',				'Манчестер Юнайтед',	'2016.08.20',	2),
				('Кристал Пэлас',		'Сток Сити',			'2016.08.20',	2),
				('Саутгемптон',			'Суонси',				'2016.08.21',	2),
				('Тоттенхэм',			'Сандерленд',			'2016.08.21',	2),
				('Манчестер Юнайтед',	'Лестер Сити',			'2016.08.19',	2),
				('Борнмут',				'Эвертон',				'2016.08.20',	2),
				('Ливерпуль',			'Халл Сити',			'2016.08.20',	2),
				('Миддлсбро',			'Тоттенхэм',			'2016.08.20',	2),
				('Сток Сити',			'Вест Бромвич',			'2016.08.20',	2),
				('Сандерленд',			'Кристал Пэлас',		'2016.08.20',	2),
				('Суонси',				'Манчестер Сити',		'2016.08.20',	2),
				('Арсенал',				'Челси',				'2016.08.20',	2),
				('Вест Хэм',			'Саутгемптон',			'2016.08.21',	2),
				('Бернли',				'Уотфорд',				'2016.08.21',	2);
/* Тур - 7-8-9 */			
INSERT INTO results (t1, t2, date, tour) VALUES
				('Эвертон',				'Кристал Пэлас',		'2016.08.19',	2),
				('Суонси',				'Ливерпуль',			'2016.08.20',	2),
				('Халл Сити',			'Челси',				'2016.08.20',	2),
				('Сандерленд',			'Вест Бромвич',			'2016.08.20',	2),
				('Уотфорд',				'Борнмут',				'2016.08.20',	2),
				('Вест Хэм',			'Миддлсбро',			'2016.08.20',	2),
				('Манчестер Юнайтед',	'Сток Сити',			'2016.08.20',	2),
				('Лестер Сити',			'Саутгемптон',			'2016.08.20',	2),
				('Тоттенхэм',			'Манчестер Сити',		'2016.08.21',	2),
				('Бернли',				'Арсенал',				'2016.08.21',	2),
				('Челси',				'Лестер Сити',			'2016.08.19',	2),
				('Арсенал',				'Суонси',				'2016.08.20',	2),
				('Борнмут',				'Халл Сити',			'2016.08.20',	2),
				('Манчестер Сити',		'Эвертон',				'2016.08.20',	2),
				('Сток Сити',			'Сандерленд',			'2016.08.20',	2),
				('Вест Бромвич',		'Тоттенхэм',			'2016.08.20',	2),
				('Кристал Пэлас',		'Вест Хэм',				'2016.08.20',	2),
				('Миддлсбро',			'Уотфорд',				'2016.08.20',	2),
				('Саутгемптон',			'Бернли',				'2016.08.21',	2),
				('Ливерпуль',			'Манчестер Юнайтед',	'2016.08.21',	2),
				('Борнмут',				'Тоттенхэм',			'2016.08.19',	2),
				('Арсенал',				'Миддлсбро',			'2016.08.20',	2),
				('Бернли',				'Эвертон',				'2016.08.20',	2),
				('Халл Сити',			'Сток Сити',			'2016.08.20',	2),
				('Лестер Сити',			'Кристал Пэлас',		'2016.08.20',	2),
				('Суонси',				'Уотфорд',				'2016.08.20',	2),
				('Вест Хэм',			'Сандерленд',			'2016.08.20',	2),
				('Ливерпуль',			'Вест Бромвич',			'2016.08.20',	2),
				('Манчестер Сити',		'Саутгемптон',			'2016.08.21',	2),
				('Челси',				'Манчестер Юнайтед',	'2016.08.21',	2);
				
/* Тур - 10-11-12 */			
INSERT INTO results (t1, t2, date, tour) VALUES
				('Сандерленд',			'Арсенал',				'2016.10.29',	10),
				('Манчестер Юнайтед',	'Бернли',				'2016.10.29',	10),
				('Миддлсбро',			'Борнмут',				'2016.10.29',	10),
				('Тоттенхэм',			'Лестер Сити',			'2016.10.29',	10),
				('Уотфорд',				'Халл Сити',			'2016.10.29',	10),
				('Вест Бромвич',		'Манчестер Сити',		'2016.10.29',	10),
				('Кристал Пэлас',		'Ливерпуль',			'2016.10.29',	10),
				('Эвертон',				'Вест Хэм',				'2016.10.30',	10),
				('Саутгемптон',			'Челси',				'2016.10.30',	10),
				('Сток Сити',			'Суонси',				'2016.10.31',	10),
				('Борнмут',				'Сандерленд',			'2016.11.05',	11),
				('Бернли',				'Кристал Пэлас',		'2016.11.05',	11),
				('Манчестер Сити',		'Миддлсбро',			'2016.11.05',	11),
				('Вест Хэм',			'Сток Сити',			'2016.11.05',	11),
				('Челси',				'Эвертон',				'2016.11.05',	11),
				('Арсенал',				'Тоттенхэм',			'2016.11.06',	11),
				('Халл Сити',			'Саутгемптон',			'2016.11.06',	11),
				('Ливерпуль',			'Уотфорд',				'2016.11.06',	11),
				('Суонси',				'Манчестер Юнайтед',	'2016.11.06',	11),
				('Лестер Сити',			'Вест Бромвич',			'2016.11.06',	11),
				('Манчестер Юнайтед',	'Арсенал',				'2016.11.19',	12),
				('Кристал Пэлас',		'Манчестер Сити',		'2016.11.19',	12),
				('Эвертон',				'Суонси',				'2016.11.19',	12),
				('Саутгемптон',			'Ливерпуль',			'2016.11.19',	12),
				('Сток Сити',			'Борнмут',				'2016.11.19',	12),
				('Сандерленд',			'Халл Сити',			'2016.11.19',	12),
				('Уотфорд',				'Лестер Сити',			'2016.11.19',	12),
				('Тоттенхэм',			'Вест Хэм',				'2016.11.19',	12),
				('Миддлсбро',			'Челси',				'2016.11.20',	12);
				
/* Тур - 13-14-15 */			
INSERT INTO results (t1, t2, date, tour) VALUES
				('Сандерленд',			'Арсенал',				'2016.10.29',	10),
				('Манчестер Юнайтед',	'Бернли',				'2016.10.29',	10),
				('Миддлсбро',			'Борнмут',				'2016.10.29',	10),
				('Тоттенхэм',			'Лестер Сити',			'2016.10.29',	10),
				('Уотфорд',				'Халл Сити',			'2016.10.29',	10),
				('Вест Бромвич',		'Манчестер Сити',		'2016.10.29',	10),
				('Кристал Пэлас',		'Ливерпуль',			'2016.10.29',	10),
				('Эвертон',				'Вест Хэм',				'2016.10.30',	10),
				('Саутгемптон',			'Челси',				'2016.10.30',	10),
				('Сток Сити',			'Суонси',				'2016.10.31',	10),
				('Борнмут',				'Сандерленд',			'2016.11.05',	11),
				('Бернли',				'Кристал Пэлас',		'2016.11.05',	11),
				('Манчестер Сити',		'Миддлсбро',			'2016.11.05',	11),
				('Вест Хэм',			'Сток Сити',			'2016.11.05',	11),
				('Челси',				'Эвертон',				'2016.11.05',	11),
				('Арсенал',				'Тоттенхэм',			'2016.11.06',	11),
				('Халл Сити',			'Саутгемптон',			'2016.11.06',	11),
				('Ливерпуль',			'Уотфорд',				'2016.11.06',	11),
				('Суонси',				'Манчестер Юнайтед',	'2016.11.06',	11),
				('Лестер Сити',			'Вест Бромвич',			'2016.11.06',	11),
				('Манчестер Юнайтед',	'Арсенал',				'2016.11.19',	12),
				('Кристал Пэлас',		'Манчестер Сити',		'2016.11.19',	12),
				('Эвертон',				'Суонси',				'2016.11.19',	12),
				('Саутгемптон',			'Ливерпуль',			'2016.11.19',	12),
				('Сток Сити',			'Борнмут',				'2016.11.19',	12),
				('Сандерленд',			'Халл Сити',			'2016.11.19',	12),
				('Уотфорд',				'Лестер Сити',			'2016.11.19',	12),
				('Тоттенхэм',			'Вест Хэм',				'2016.11.19',	12),
				('Миддлсбро',			'Челси',				'2016.11.20',	12);
				
/* Тур - 13 */			
INSERT INTO results (t1, t2, date, tour) VALUES
				('Бернли',				'Манчестер Сити',		'2016.11.26',	13),
				('Халл Сити',			'Вест Бромвич',			'2016.11.26',	13),
				('Лестер Сити',			'Миддлсбро',			'2016.11.26',	13),
				('Ливерпуль',			'Сандерленд',			'2016.11.26',	13),
				('Суонси',				'Кристал Пэлас',		'2016.11.26',	13),
				('Челси',				'Тоттенхэм',			'2016.11.26',	13),
				('Уотфорд',				'Сток Сити',			'2016.08.27',	13),
				('Арсенал',				'Борнмут',				'2016.08.27',	13),
				('Манчестер Юнайтед',	'Вест Хэм',				'2016.08.27',	13),
				('Саутгемптон',			'Эвертон',				'2016.08.27',	13);	
				
SELECT * FROM results;

UPDATE results	SET tour = 9	WHERE id > 80;

UPDATE results	SET date = '2016.10.23'	WHERE id > 88;
UPDATE results	SET date = '2016.09.30'	WHERE id = 61;
UPDATE results	SET date = '2016.09.10'	WHERE id > 30 AND id < 39;
UPDATE results	SET date = '2016.08.27'	WHERE id < 23;
UPDATE results	SET date = '2016.09.26'	WHERE id = 60;
UPDATE results	SET date = '2016.08.27'	WHERE date = '2016-08-20' AND tour = 3;
UPDATE results	SET date = '2016.08.27'	WHERE date = '2016-08-20' OR date = '2016-08-19' AND tour = 3;
		
				
				
CREATE TRIGGER `before_update_cost`
BEFORE UPDATE ON `trigger_items_cost` FOR EACH ROW
BEGIN
IF NEW.cost < 50 THEN
SET NEW.cost = 50;
ELSEIF NEW.cost > 50 AND NEW.cost < 100 THEN
SET NEW.cost = 100;
END IF;
END

CREATE TRIGGER after_update_rt1
AFTER UPDATE ON rt1 FOR EACH ROW
BEGIN
IF NEW.g1 > NEW.g2 THEN
	 pl1(name)
END

ALTER TABLE results ADD INDEX tur (tour);		

EXPLAIN SELECT * FROM results WHERE tour = 1;
SELECT * FROM results WHERE tour = 1;
				
CREATE TABLE result_s SELECT * FROM results;				